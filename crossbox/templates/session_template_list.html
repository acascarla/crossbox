{% extends 'base.html' %}
{% block content %}
  <div class='template_session_title'>
    <span>Configurador de Sesiones</span>
  </div>
  <div id="container">
    <div class='week_template_div'>
      <form action="{% url 'session-template-switch' %}" method="post">
        <input type="hidden" id="week_template" name="week_template" value="{{ current_week_template }}">
        <select name="week_template" onchange="this.form.submit()">
          {% for week_template in week_templates %}
            <option value="{{week_template.pk}}" {% if week_template.pk == current_week_template %}selected="true"{%else%}{%endif%}>{{week_template.name}}</option>
          {% endfor %}
        </select>
      </form>
    </div>
    <div class='week_template_div'>
      <table class="week_template_table">
        <thead>
          <tr>
            <th>DÃ­a</th>
            {% for h in hours %}
              <th>{{ h }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
        {% for day_row in days %}
          <tr>
            <td>{{ day_row.0 }}</td>
            {% for day in day_row|slice:"1:" %}
              <td class="{% if not day.session %}template_session_not_marked{% else %}template_session_marked{% endif %}" data-title='{{ day.hour_title }}'>
                <form action="{% if day.session %}{% url 'session-template-delete' %}{% else %}{% url 'session-template-create' %}{% endif %}" method="post">
                  <input type="hidden" id="session" name="session" value="{{ day.session }}">
                  <input type="hidden" id="day" name="day" value="{{ day.day }}">
                  <input type="hidden" id="hour" name="hour" value="{{ day.hour }}">
                  <input type="hidden" id="week_template" name="week_template" value="{{ current_week_template }}">
                  <button class="reserva_submit {% if not day.session %}template_session_not_marked{% else %}template_session_marked{% endif %}" type="submit">
                      <i class="fa {% if day.session %}fa-check{% else %}fa-plus{% endif %}"></i>
                  </button>
                </form>
              </td>
            {% endfor %}
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
    <div class="apply_sessions_to_week_container">
      <span>Generar sesiones en la semana:</span>
      <form action="{% url 'generate-sessions' %}" method="get">
        <select id="page" name="page">
          {% for page, week_label in weeks.items %}
            <option value="{{ page }}">{{ week_label }}</option>
          {% endfor %}
        </select>
        <br>
        <input type="submit" value="Generar">
      </form>
    </div>
  </div>
{% endblock content %}
